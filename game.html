<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>$SHUFF Golf Game</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: url('images/background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    body::after {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: -1;
    }

    .game-container {
      max-width: 900px;
      margin: 2rem auto;
      background: rgba(0, 0, 0, 0.7);
      padding: 2rem;
      border-radius: 15px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
    }

    h1 {
      color: #fff;
      margin-bottom: 1.5rem;
      font-size: 2.2rem;
      text-align: center;
      background: linear-gradient(90deg, #2ecc71, #3498db);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    #game-canvas {
      background: linear-gradient(to bottom, #87CEEB, #1E90FF);
      border-radius: 12px;
      margin: 1.5rem auto;
      display: block;
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      width: 100%;
      max-width: 800px;
      height: auto;
      aspect-ratio: 2/1;
      border: 3px solid rgba(255,255,255,0.2);
    }

    #wallet-info {
      background: rgba(0,0,0,0.5);
      padding: 1.2rem;
      border-radius: 10px;
      margin: 1rem 0;
      text-align: left;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin: 1rem 0;
    }

    button {
      background: linear-gradient(90deg, #3498db, #2980b9);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.3s ease;
      flex: 1 0 auto;
      min-width: 140px;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
      opacity: 0.9;
    }

    button:disabled {
      background: #95a5a6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      opacity: 0.7;
    }

    #swing-input-container {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      align-items: center;
      margin: 1.5rem 0;
    }

    input {
      padding: 0.8rem 1rem;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 8px;
      font-size: 1rem;
      min-width: 220px;
      flex: 1 0 auto;
      background: rgba(0,0,0,0.5);
      color: white;
      transition: all 0.3s ease;
    }

    input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 2px rgba(52,152,219,0.3);
    }

    #status {
      margin: 1rem 0;
      min-height: 24px;
      color: #fff;
      font-weight: bold;
      text-align: center;
      padding: 0.8rem;
      background: rgba(46, 204, 113, 0.2);
      border-radius: 8px;
      border: 1px solid rgba(46, 204, 113, 0.3);
    }

    #game-info {
      margin: 1rem 0;
      padding: 1rem;
      background: rgba(0,0,0,0.5);
      border-radius: 10px;
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      gap: 1rem;
      border: 1px solid rgba(255,255,255,0.1);
    }

    #game-info p {
      margin: 0;
      font-size: 1.1rem;
      color: #fff;
    }

    #game-info span {
      font-weight: bold;
      color: #2ecc71;
    }

    #loading-spinner {
      margin: 1.5rem 0;
      text-align: center;
      display: none;
    }

    .spinner {
      border: 4px solid rgba(255,255,255,0.3);
      border-top: 4px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #leaderboard {
      background: rgba(0,0,0,0.5);
      padding: 1.5rem;
      border-radius: 10px;
      margin-top: 2rem;
      border: 1px solid rgba(255,255,255,0.1);
    }

    #leaderboard h2 {
      color: #fff;
      margin-bottom: 1rem;
      text-align: center;
      font-size: 1.5rem;
    }

    #leaderboard-list {
      list-style: none;
      padding: 0;
    }

    #leaderboard-list li {
      padding: 0.8rem;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex;
      justify-content: space-between;
      color: #fff;
    }

    #leaderboard-list li:last-child {
      border-bottom: none;
    }

    #leaderboard-timeleft, #prize-pool {
      text-align: center;
      margin-bottom: 1rem;
      color: #f1c40f;
      font-weight: bold;
    }

    @media (max-width: 768px) {
      .game-container {
        padding: 1.5rem;
        margin: 1rem;
      }

      h1 {
        font-size: 1.8rem;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
      }

      #swing-input-container {
        flex-direction: column;
      }

      input {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>‚õ≥ $SHUFF Golf Challenge</h1>
    
    <div class="button-group">
      <button id="connect-wallet-btn">Connect Wallet</button>
      <button id="disconnect-btn" disabled>Disconnect</button>
      <button id="new-game-btn">New Game</button>
    </div>

    <div id="wallet-info" style="display:none;">
      <p>Wallet Address: <span id="wallet-address"></span></p>
      <p>Balance: <span id="wallet-balance">1000</span> SHUFF</p>
    </div>

    <div id="game-info">
      <p>Strokes: <span id="stroke-count">0</span></p>
      <p>Distance to Hole: <span id="distance-to-hole">-</span> ft</p>
      <p>Status: <span id="game-status">Ready to play</span></p>
    </div>

    <div id="swing-input-container">
      <input type="number" id="swing-amount" placeholder="Enter SHUFF amount (0.1-100)" min="0.1" max="100" step="0.1">
      <button id="swing-btn" disabled>Swing!</button>
    </div>

    <div id="status">Connect your wallet to start playing</div>

    <div id="loading-spinner">
      <div class="spinner"></div>
      <p>Processing your swing...</p>
    </div>

    <canvas id="game-canvas"></canvas>

    <div id="leaderboard">
      <h2>üèÜ Current Leaderboard</h2>
      <p id="leaderboard-timeleft">Season ends in: <span id="time-remaining">30 days</span></p>
      <p id="prize-pool">Prize Pool: <span id="prize-amount">2500</span> SHUFF</p>
      <ul id="leaderboard-list">
        <li><span>1. Demo1...Wxyz</span><span>5 ft</span></li>
        <li><span>2. Demo2...Abcd</span><span>12 ft</span></li>
        <li><span>3. Demo3...Efgh</span><span>18 ft</span></li>
      </ul>
    </div>
  </div>

  <script>
    // Game Configuration
    const HOLE_IN_ONE_CHANCE = 1 / 10000;
    const PIXELS_TO_FEET = 0.3;
    const TEE_BOX_POSITION = { x: 50, y: 300 };
    const TEE_BOX_RADIUS = 20;
    
    // Game State
    let walletAddress = null;
    let animationFrameId = null;
    let isWaitingForNextShot = false;
    
    let gameState = {
      ballPosition: { ...TEE_BOX_POSITION },
      ballVelocity: { x: 0, y: 0 },
      isMoving: false,
      strokes: 0,
      lastSwingAmount: 0,
      holePosition: { x: 700, y: 300 },
      holeRadius: 8,
      ballRadius: 8,
      hazards: {
        water: [],
        sand: []
      },
      gameActive: false,
      disqualified: false,
      canvasWidth: 800,
      canvasHeight: 400
    };

    // DOM Elements
    const connectBtn = document.getElementById('connect-wallet-btn');
    const disconnectBtn = document.getElementById('disconnect-btn');
    const newGameBtn = document.getElementById('new-game-btn');
    const walletAddressSpan = document.getElementById('wallet-address');
    const swingAmountInput = document.getElementById('swing-amount');
    const swingBtn = document.getElementById('swing-btn');
    const statusDiv = document.getElementById('status');
    const loadingSpinner = document.getElementById('loading-spinner');
    const strokeCountSpan = document.getElementById('stroke-count');
    const distanceToHoleSpan = document.getElementById('distance-to-hole');
    const gameStatusSpan = document.getElementById('game-status');
    const gameCanvas = document.getElementById('game-canvas');
    const ctx = gameCanvas.getContext('2d');

    // Initialize Canvas
    function initializeCanvas() {
      gameCanvas.width = gameState.canvasWidth;
      gameCanvas.height = gameState.canvasHeight;
      drawGame();
    }

    // Draw Game Elements
    function drawGame() {
      // Clear canvas
      ctx.clearRect(0, 0, gameCanvas.width, gameCanvas.height);
      
      // Draw sky gradient
      const skyGradient = ctx.createLinearGradient(0, 0, 0, gameCanvas.height);
      skyGradient.addColorStop(0, '#87CEEB');
      skyGradient.addColorStop(1, '#1E90FF');
      ctx.fillStyle = skyGradient;
      ctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
      
      // Draw ground
      ctx.fillStyle = '#4CAF50';
      ctx.fillRect(0, 300, gameCanvas.width, gameCanvas.height - 300);
      
      // Draw fairway (light green path)
      ctx.fillStyle = '#2E8B57';
      ctx.beginPath();
      ctx.moveTo(50, 300);
      ctx.bezierCurveTo(200, 290, 400, 290, 650, 300);
      ctx.bezierCurveTo(750, 310, 750, 310, 650, 320);
      ctx.bezierCurveTo(400, 330, 200, 330, 50, 320);
      ctx.closePath();
      ctx.fill();
      
      // Draw rough (darker green outside fairway)
      ctx.fillStyle = '#3CB371';
      ctx.beginPath();
      ctx.moveTo(0, 300);
      ctx.lineTo(0, 400);
      ctx.lineTo(800, 400);
      ctx.lineTo(800, 300);
      ctx.bezierCurveTo(750, 310, 650, 310, 650, 300);
      ctx.bezierCurveTo(650, 290, 750, 290, 800, 300);
      ctx.closePath();
      ctx.fill();
      
      // Draw green
      ctx.fillStyle = '#7CFC00';
      ctx.beginPath();
      ctx.arc(gameState.holePosition.x, gameState.holePosition.y, 50, 0, Math.PI * 2);
      ctx.fill();
      
      // Draw hole
      ctx.fillStyle = 'black';
      ctx.beginPath();
      ctx.arc(gameState.holePosition.x, gameState.holePosition.y, gameState.holeRadius, 0, Math.PI * 2);
      ctx.fill();
      
      // Draw flag
      ctx.fillStyle = 'red';
      ctx.fillRect(gameState.holePosition.x - 2, gameState.holePosition.y - 40, 4, 40);
      ctx.beginPath();
      ctx.moveTo(gameState.holePosition.x, gameState.holePosition.y - 40);
      ctx.lineTo(gameState.holePosition.x + 15, gameState.holePosition.y - 30);
      ctx.lineTo(gameState.holePosition.x, gameState.holePosition.y - 20);
      ctx.closePath();
      ctx.fill();
      
      // Draw water hazard (left of green)
      ctx.fillStyle = 'rgba(30, 144, 255, 0.7)';
      ctx.beginPath();
      ctx.moveTo(580, 320);
      ctx.bezierCurveTo(620, 310, 650, 320, 680, 330);
      ctx.lineTo(680, 350);
      ctx.lineTo(580, 350);
      ctx.closePath();
      ctx.fill();
      
      // Draw sand bunker (right of green)
      ctx.fillStyle = '#F5DEB3';
      ctx.beginPath();
      ctx.arc(750, 280, 30, 0, Math.PI * 2);
      ctx.fill();
      
      // Draw tee box
      ctx.fillStyle = 'rgba(255, 255, 255, 0.2)';
      ctx.beginPath();
      ctx.arc(TEE_BOX_POSITION.x, TEE_BOX_POSITION.y, TEE_BOX_RADIUS, 0, Math.PI * 2);
      ctx.fill();
      ctx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // Draw ball if not in tee box position
      if (gameState.ballPosition.x !== TEE_BOX_POSITION.x || gameState.ballPosition.y !== TEE_BOX_POSITION.y) {
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.arc(gameState.ballPosition.x, gameState.ballPosition.y, gameState.ballRadius, 0, Math.PI * 2);
        ctx.fill();
        ctx.strokeStyle = 'black';
        ctx.stroke();
      }
      
      // Update distance display
      updateDistanceDisplay();
    }

    // Update distance display
    function updateDistanceDisplay() {
      const dx = gameState.ballPosition.x - gameState.holePosition.x;
      const dy = gameState.ballPosition.y - gameState.holePosition.y;
      const distance = Math.sqrt(dx * dx + dy * dy) * PIXELS_TO_FEET;
      distanceToHoleSpan.textContent = Math.round(distance);
    }

    // Connect Wallet (Mock)
    async function connectWallet() {
      try {
        connectBtn.disabled = true;
        statusDiv.textContent = "Connecting to wallet...";
        
        // Mock wallet connection
        walletAddress = "DemoWallet1234567890";
        
        walletAddressSpan.textContent = `${walletAddress.substring(0,4)}...${walletAddress.substring(walletAddress.length - 4)}`;
        document.getElementById('wallet-info').style.display = 'block';
        
        newGameBtn.disabled = false;
        swingBtn.disabled = false;
        disconnectBtn.disabled = false;
        
        statusDiv.textContent = "Wallet connected successfully! (Demo Mode)";
        statusDiv.style.color = "#2ecc71";
        
      } catch (err) {
        console.error("Wallet connection error:", err);
        statusDiv.textContent = `Connection failed: ${err.message}`;
        statusDiv.style.color = "#e74c3c";
        connectBtn.disabled = false;
      }
    }

    // Disconnect Wallet (Mock)
    async function disconnectWallet() {
      walletAddress = null;
      document.getElementById('wallet-info').style.display = 'none';
      connectBtn.disabled = false;
      disconnectBtn.disabled = true;
      newGameBtn.disabled = true;
      swingBtn.disabled = true;
      statusDiv.textContent = "Wallet disconnected";
      statusDiv.style.color = "#3498db";
    }

    // Initialize New Game
    function initializeGame() {
      gameState = {
        ballPosition: { ...TEE_BOX_POSITION },
        ballVelocity: { x: 0, y: 0 },
        isMoving: false,
        strokes: 0,
        lastSwingAmount: 0,
        holePosition: { x: 700, y: 300 },
        holeRadius: 8,
        ballRadius: 8,
        hazards: {
          water: [
            { x: 580, y: 320, width: 100, height: 30 }
          ],
          sand: [
            { x: 750, y: 280, radius: 30 }
          ]
        },
        gameActive: true,
        disqualified: false,
        canvasWidth: 800,
        canvasHeight: 400
      };
      
      strokeCountSpan.textContent = "0";
      gameStatusSpan.textContent = "Ready to swing";
      isWaitingForNextShot = false;
      swingBtn.disabled = false;
      drawGame();
    }

    // Make Swing (Mock)
    async function makeSwing() {
      const swingAmount = parseFloat(swingAmountInput.value);
      
      if (isNaN(swingAmount) {
        statusDiv.textContent = "Please enter a valid SHUFF amount";
        statusDiv.style.color = "#e74c3c";
        return;
      }
      
      if (swingAmount < 0.1 || swingAmount > 100) {
        statusDiv.textContent = "Please enter between 0.1 and 100 SHUFF";
        statusDiv.style.color = "#e74c3c";
        return;
      }
      
      if (isWaitingForNextShot) {
        statusDiv.textContent = "Complete your current shot first!";
        statusDiv.style.color = "#e74c3c";
        return;
      }
      
      try {
        loadingSpinner.style.display = 'block';
        swingBtn.disabled = true;
        statusDiv.textContent = "Preparing swing...";
        
        // Mock processing delay
        await new Promise(resolve => setTimeout(resolve, 800));
        
        // Update game state
        gameState.strokes++;
        gameState.lastSwingAmount = swingAmount;
        strokeCountSpan.textContent = gameState.strokes;
        
        // Calculate swing physics
        const dx = gameState.holePosition.x - gameState.ballPosition.x;
        const dy = gameState.holePosition.y - gameState.ballPosition.y;
        const distance = Math.sqrt(dx * dx + dy * dy) * PIXELS_TO_FEET;
        
        const power = swingAmount * 0.5;
        const directionNoise = (Math.random() - 0.5) * 0.2;
        
        gameState.ballVelocity = {
          x: (dx / distance + directionNoise) * power,
          y: (dy / distance + directionNoise) * power
        };
        
        gameState.isMoving = true;
        gameStatusSpan.textContent = "Ball in flight...";
        
        statusDiv.textContent = `Swing with ${swingAmount} SHUFF!`;
        statusDiv.style.color = "#2ecc71";
        
        // Start animation
        animateBall();
        
      } catch (err) {
        console.error("Swing error:", err);
        statusDiv.textContent = `Swing failed: ${err.message}`;
        statusDiv.style.color = "#e74c3c";
      } finally {
        loadingSpinner.style.display = 'none';
      }
    }

    // Animate Ball Movement
    function animateBall() {
      if (!gameState.isMoving) return;
      
      // Apply physics
      gameState.ballVelocity.x *= 0.98;
      gameState.ballVelocity.y *= 0.98;
      
      // Update position
      gameState.ballPosition.x += gameState.ballVelocity.x;
      gameState.ballPosition.y += gameState.ballVelocity.y;
      
      // Check for collisions
      checkCollisions();
      
      // Redraw game
      drawGame();
      
      // Check if ball stopped
      const speed = Math.sqrt(
        gameState.ballVelocity.x * gameState.ballVelocity.x +
        gameState.ballVelocity.y * gameState.ballVelocity.y
      );
      
      if (speed < 0.5) {
        gameState.isMoving = false;
        
        // Check if ball is in hole
        const dx = gameState.ballPosition.x - gameState.holePosition.x;
        const dy = gameState.ballPosition.y - gameState.holePosition.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < gameState.holeRadius + gameState.ballRadius) {
          gameStatusSpan.textContent = "Hole in one! üéâ";
          statusDiv.textContent = `AMAZING! You got a hole-in-one with ${gameState.lastSwingAmount} SHUFF!`;
          statusDiv.style.color = "#f1c40f";
        } else {
          gameStatusSpan.textContent = "Ball at rest";
          statusDiv.textContent = `Ball landed! Distance: ${Math.round(distance * PIXELS_TO_FEET)} ft from hole`;
          statusDiv.style.color = "#2ecc71";
        }
        
        // Pause before allowing next shot
        isWaitingForNextShot = true;
        setTimeout(() => {
          resetBallToTee();
          isWaitingForNextShot = false;
          swingBtn.disabled = false;
        }, 2000);
      } else {
        animationFrameId = requestAnimationFrame(animateBall);
      }
    }

    // Reset ball to tee position
    function resetBallToTee() {
      gameState.ballPosition = { ...TEE_BOX_POSITION };
      drawGame();
      gameStatusSpan.textContent = "Ready for next swing";
    }

    // Check Collisions
    function checkCollisions() {
      // Check water hazard
      for (const water of gameState.hazards.water) {
        if (isPointInEllipse(gameState.ballPosition, water)) {
          gameStatusSpan.textContent = "Ball in water! Try again";
          statusDiv.textContent = "Oops! Your ball landed in the water hazard";
          statusDiv.style.color = "#e74c3c";
          gameState.disqualified = true;
          gameState.gameActive = false;
          cancelAnimationFrame(animationFrameId);
          
          // Reset after delay
          setTimeout(() => {
            resetBallToTee();
            gameState.disqualified = false;
            gameState.gameActive = true;
            swingBtn.disabled = false;
          }, 2000);
          return;
        }
      }
      
      // Check sand bunkers
      for (const sand of gameState.hazards.sand) {
        const dx = gameState.ballPosition.x - sand.x;
        const dy = gameState.ballPosition.y - sand.y;
        const distance = Math.sqrt(dx * dx + dy * dy);
        
        if (distance < sand.radius) {
          // Apply sand resistance
          gameState.ballVelocity.x *= 0.9;
          gameState.ballVelocity.y *= 0.9;
        }
      }
      
      // Check boundaries
      if (gameState.ballPosition.x < gameState.ballRadius || 
          gameState.ballPosition.x > gameState.canvasWidth - gameState.ballRadius ||
          gameState.ballPosition.y < gameState.ballRadius || 
          gameState.ballPosition.y > gameState.canvasHeight - gameState.ballRadius) {
        gameState.ballVelocity.x = -gameState.ballVelocity.x * 0.5;
        gameState.ballVelocity.y = -gameState.ballVelocity.y * 0.5;
      }
    }

    // Helper function to check if point is in ellipse
    function isPointInEllipse(point, ellipse) {
      const dx = point.x - (ellipse.x + ellipse.width/2);
      const dy = point.y - (ellipse.y + ellipse.height/2);
      return (dx*dx)/(ellipse.width*ellipse.width/4) + 
             (dy*dy)/(ellipse.height*ellipse.height/4) <= 1;
    }

    // Initialize on load
    window.addEventListener('load', () => {
      initializeCanvas();
      
      // Set up event listeners
      connectBtn.addEventListener('click', connectWallet);
      disconnectBtn.addEventListener('click', disconnectWallet);
      newGameBtn.addEventListener('click', initializeGame);
      swingBtn.addEventListener('click', makeSwing);
    });
  </script>
</body>
</html>
